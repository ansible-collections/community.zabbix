---
- name: Get apiinfo facts
  zabbix_apiinfo_facts:
    server_url: "{{ zabbix_api_server_url }}"
    login_user: "{{ zabbix_api_login_user }}"
    login_password: "{{ zabbix_api_login_pass }}"
  register: zbxapiinfo_get

- assert:
    that:
      - zbxapiinfo_get.failed is sameas False
      - zbxapiinfo_get.apiinfo.version is version(zabbix_version, '>=')

- name: Get apiinfo facts
  zabbix_apiinfo_facts:
  environment:
    ZABBIX_SERVER: "{{ zabbix_api_server_url }}"
    ZABBIX_USERNAME: "{{ zabbix_api_login_user }}"
    ZABBIX_PASSWORD: "{{ zabbix_api_login_pass }}"
  register: zbxapiinfo_get

- assert:
    that:
      - zbxapiinfo_get.failed is sameas False
      - zbxapiinfo_get.apiinfo.version is version(zabbix_version, '>=')