---
- include_tasks: tlspsk_auto_linux.yml
  when: (ansible_os_family != "Windows") or (zabbix_agent_docker | bool)

- include_tasks: tlspsk_auto_windows.yml
  when: ansible_os_family == "Windows"

- name: AutoPSK | Default tlsaccept and tlsconnect to enforce PSK
  set_fact:
    zabbix_agent_tlsaccept: psk
    zabbix_agent_tlsconnect: psk
  when: zabbix_api_create_hosts
  tags:
    - config
